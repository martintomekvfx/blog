---
import BaseLayout from "./BaseLayout.astro";
import TagList from "../components/TagList.astro";
import TableOfContents from "../components/TableOfContents.astro";

interface Props {
  title: string;
  description: string;
  pubDate: Date;
  updatedDate?: Date;
  heroImage?: string;
  tags?: string[];
  headings?: { depth: number; slug: string; text: string }[];
}

const { title, description, pubDate, updatedDate, heroImage, tags = [], headings = [] } =
  Astro.props;

const formattedDate = pubDate.toLocaleDateString("en-US", {
  year: "numeric",
  month: "long",
  day: "numeric",
});

const formattedUpdated = updatedDate?.toLocaleDateString("en-US", {
  year: "numeric",
  month: "long",
  day: "numeric",
});
---

<BaseLayout title={`${title} | Blog`} description={description} image={heroImage}>
  <article class="py-4">
    <header class="mb-8">
      <h1 class="text-3xl sm:text-4xl font-bold text-balance mb-3">
        {title}
      </h1>
      <div class="flex flex-wrap items-center gap-x-3 gap-y-1 text-sm opacity-60">
        <time datetime={pubDate.toISOString()}>{formattedDate}</time>
        {formattedUpdated && (
          <span>
            (updated {formattedUpdated})
          </span>
        )}
      </div>
      {tags.length > 0 && (
        <div class="mt-3">
          <TagList tags={tags} />
        </div>
      )}
    </header>

    {heroImage && (
      <img
        src={heroImage}
        alt={title}
        class="w-full mb-8 border border-white"
        loading="eager"
      />
    )}

    {headings.length > 0 && (
      <TableOfContents headings={headings} />
    )}

    <div class="prose prose-lg max-w-none text-pretty">
      <slot />
    </div>
  </article>
</BaseLayout>
